\chapter{Controlling Weakly-coupled Carbon Spins}
Once the nuclear-spin environment of the NV-center has been characterized it is possible to control it.
This chapter will demonstrate initialization, control and readout of weakly coupled carbon spins before explaining how an entangled state can be created using parity measurements. We will then demonstrate the created entanglement using quantum state tomography.





[Note intro needs to be rewritten once chapter is done]\\
Now that we have identified several promising carbon spins we will go into controlling them.

In order to demonstrate entanglement we must be able to initialize the system, perform a parity measurement to create the entanglement and make a tomography to demonstrate it.
This chapter will explain what operations need to be performed.

This chapter attempts to explain first how we can control a carbon by explaining how the two different rotation axes from the last chapter can be used to implement a conditional +-X gate. A gate similar to a CNOT gate.
Now that we understand how to implement a cnot gate we will use this to perform an experiment that we call a carbon ramsey on an unitialized state.
AFterwards we will use this to show that we can initialize and readout by showing an initialized carbon ramsey. (1buit tomo (ramsey with more T +Z-RO?).
From this we will also determine $T_{2 \mathrm{C}}^*$.

The next section will consider two qubit control.
It will start by explaining how we can perform a parity measurement. This measurement allows us to perform a two qubit tomography and create entanglement by projection.
We will then show



\section{Initialization and readout}
The $\pm\mathrm{x}$-gate can be used to initialize a carbon-spin.
To initialize a carbon-spin  in the $ \ket{X}$-state the gate-circuit as depicted in \cref{fig:gate_circuit_mbi_x-init} is implemented.

After the electronic-spin is brought in the $\ket{X}$-state the two-qubit system can be described by the tensor product of two density matrices:
\begin{equation}
    \rho_X \otimes \rho_m = \rho_X \otimes \rho_{X} +\rho_X \otimes \rho_{-X}
\end{equation}
By applying the $\pm{\mathrm{x}}$-gate  the electronic-spin picks up a phase depending on the nuclear spin-state:
\begin{equation}
     \rho_Y \otimes \rho_{X} +\rho_{-Y} \otimes \rho_{-X}
    \label{eq:density_after_Ren}
\end{equation}

The effect of the $\pm{\mathrm{x}}$-gate can be made more easily understood by treating the carbon-spin as being either in the $\ket{X}$ or $\ket{-X}$-state. Treating both as separate cases below.
\begin{align}
    \quad &\ket{X}\ket{X} &\vee \quad &  \quad\ket{X}\ket{-X}\\
    \quad &\frac{\ket{0}+\ket{1}}{\sqrt{2}}\ket{X} &\vee \quad & \quad \frac{\ket{0}+\ket{1}}{\sqrt{2}}\ket{-X} \\
    \quad &\frac{e^{-i\pi/4}\ket{0}+e^{i\pi/4}\ket{1}}{\sqrt{2}}\ket{X} &\vee \quad & \quad \frac{e^{i\pi/4}\ket{0}+e^{-i\pi/4}\ket{1}}{\sqrt{2}}\ket{-X}\\
    \quad &\ket{Y}\ket{X} &\vee \quad & \quad \ket{-Y}\ket{-X}
\end{align}
The final x-pulse is used to read out the electron. By conditionalizing the experiment on getting the outcome $\ket{0}_e$ the carbon is initialized in the $\ket{X}_C$-state.
\begin{equation}
    \rho_0 \otimes \rho_{\mathrm{X}} + \rho_1 \otimes \rho_{\mathrm{-X}}
\end{equation}

\begin{figure}[htbp]
    \centering
    \begin{subfigure}[t]{0.49\textwidth}
    \centering
    \caption{}
    \mbox{
        \Qcircuit @C=1em @R=.7em {
        \lstick{\ket{0}_e}                        & \gate{\mathrm{y}}  & \ctrl{1}       & \gate{\mathrm{x}} &\qw          &  \meter \\
        \lstick{\rho_\mathrm{m}}         & \qw              &  \gate{\pm \mathrm{x}}     & \qw    & \qw   & \qw}}
    \label{fig:gate_circuit_mbi_x-init}
    \end{subfigure}
    \begin{subfigure}[t]{0.49\textwidth}
        \centering
        \caption{}
        \mbox{
        \Qcircuit @C=1em @R=.7em {
            \lstick{\ket{0}_e} & \gate{\mathrm{y}}  & \ctrl{1} & \gate{\mathrm{x}} &\ctrl{1} &  \meter \\
            \lstick{\rho_\mathrm{m}}& \qw&  \gate{\pm \mathrm{x}}     & \qw    & \gate{\mp \mathrm{y}}    & \qw}}
        \label{fig:gate_circuit_mbi_swap-init}
    \end{subfigure}
    \caption{\Cref{fig:gate_circuit_mbi_x-init} MBI-based initialization into $\pm \ket{\mathrm{X}}$. Initializes the carbon into $\ket{X}_\mathrm{C} $ when $\ket{0}_e$ is measured and into $\ket{-X}_\mathrm{C} $ when $\ket{1}_e$ is measured for the electron.
    \Cref{fig:gate_circuit_mbi_swap-init} MBI-swap initialization into $ \ket{\mathrm{0}}$. Initializes the carbon into $\ket{0}_\mathrm{C} $ regardless of the electronic spin-state measured.}
    \label{fig:gate_circuit_initialization}
\end{figure}

The sequence can be extended to a swap type initialization by implementing an additional $\mp{\mathrm{y}}$-gate.
The effect of the extra y-gate is that both the  $\ket{X}_\mathrm{C} $ and the  $\ket{-X}_\mathrm{C} $-state are rotated to the  $\ket{0}_\mathrm{C} $-state, effectively swapping the mixed state from the carbon to the electron.
By applying a readout the electron can be reinitialized.

\begin{figure}[htbp]
    \centering
    \includegraphics{Img/RO_and_init_C1.pdf}
    \caption{Demonstration of carbon control. Figure shows carbon-1 }
    \label{fig:control_demo}
\end{figure}


% Want to explain here how frequency is determined down to Hz accuracy.
\section{Parity measurement}

Initialization by conditionalizing on parity measurement and Readout parities.
Measurement projects into parity or no parity.
\begin{figure}[htbp]
    \centering
\mbox{
\Qcircuit @C=1em @R=.7em {
\lstick{\ket{0}_e} & \gate{\mathrm{y}}  & \ctrl{1} &  \ctrl{2} & \gate{\mathrm{y}}  & \ctrl{1} &  \ctrl{2} &  \meter &\qw\\
\lstick{\ket{0}_{C1}} & \qw&  \gate{\pm \mathrm{x}}  &\qw  &\qw  & \gate{\pm \mathrm{x}} & \qw   &\qw&\qw& \\
\lstick{\ket{0}_{C2}}& \qw& \qw  & \gate{\pm \mathrm{x}}    & \qw    &\qw& \gate{\pm \mathrm{x}}    & \qw &\qw&}}
    \caption{General parity RO}
    \label{fig:gate_circuit_general_Parity_RO}
\end{figure}

\section{Demonstrating entanglement}

\subsection{Tomography}
\subsection{Result}
\begin{figure}[htbp]
    \begin{subfigure}[t]{0.49\textwidth}\centering
        \caption{}
        \includegraphics{Img/uu-no-parity.pdf}
        \label{fig:uu-init }
    \end{subfigure}
    \begin{subfigure}[t]{0.49\textwidth}\centering
        \caption{}
        \includegraphics{Img/uu-XX-parity.pdf}
        \label{fig:uu-XX}
    \end{subfigure}

    \begin{subfigure}[t]{0.49\textwidth}\centering
        \caption{}
        \includegraphics{Img/ud-no-parity.pdf}
        \label{fig:ud-init }
    \end{subfigure}
    \begin{subfigure}[t]{0.49\textwidth}\centering
        \caption{}
        \includegraphics{Img/ud-XX-parity.pdf}
        \label{fig:ud-XX}
    \end{subfigure}
    \caption{ Preliminary data
    \cref{fig:uu-init } Fidelity to guess  = 0.814256440281 +/- 0.0168202298443\\
    \cref{fig:uu-XX}  Fidelity to guess  = 0.765954332553 +/- 0.0174228538115\\
    \cref{fig:ud-init } Fidelity to guess  = 0.809865339578 +/- 0.0168850158243\\
    \cref{fig:ud-XX}  Fidelity to guess  = 0.760831381733 +/- 0.0174356869379
    }
    \label{fig:2qubitTomos}
\end{figure}

% What bars to include?
% Experiment that initializes both carbons + bar graph? -> to explain how to read + to explain

% 20140810 122740 Z Z init
%  20140810 132412  YYparity
%
% \begin{figure}[htbp]
%     \centering
% \mbox{
% \Qcircuit @C=1em @R=.7em {
% \lstick{\ket{0}_e} & \gate{\mathrm{y}}  & \ctrl{1} &  \ctrl{2} & \gate{y}  &  \meter &\qw\\
% \lstick{\ket{0}_{C1}} & \qw&  \gate{\pm \mathrm{x}}  &\qw  & \qw       &\qw&\qw& \\
% \lstick{\ket{0}_{C2}}& \qw& \qw  & \gate{\pm \mathrm{x}}    & \qw      &\qw&\qw&}}
%     \caption{XX-parity-measurement}
%     \label{fig:gate_circuit_XX-parity-measurement}
% \end{figure}



%  Should emphasize difficulty in seperating initialization and RO fidelity, what is not working? Is it working?


